
$projectRoot = Join-Path "$PSScriptRoot" "\.." -Resolve

New-Item -Path "$projectRoot" -Name "tmp" -ItemType "directory" -Force | Out-Null
$tmp         = Join-Path "$projectRoot" "tmp" -Resolve
$output      = Join-Path "$projectRoot" "\addons\identity\data" -Resolve


# files
$rankFiles    = Join-Path "$projectRoot" "\resources\uniform\rank" -Resolve
#$templateFile = Join-Path "$projectRoot" "\resources\uniform\empty_zone.png" -Resolve
$templateFile = Join-Path "$projectRoot" "\resources\uniform\empty.png" -Resolve


$nameList=
    "Abate",
    "Abbassi",
    "Abejon",
    "Ackelson",
    "Acree",
    "Adams",
    "Adler",
    "Adunno",
    "Agazzi",
    "Alex",
    "Alward",
    "Anderson",
    "Anthony",
    "Apple",
    "Armitage",
    "Ashford",
    "August",
    "Babcock",
    "Bacon",
    "Baeder",
    "Baker",
    "Ball",
    "Bane",
    "Banes",
    "Barichmann",
    "Barone",
    "Bartisius",
    "Baruch",
    "Bean",
    "Bearden",
    "Beauchamp",
    "Beck",
    "Becks",
    "Beiter",
    "Benshai",
    "Bentham",
    "Berry",
    "Biondo",
    "Bishop",
    "Bisley",
    "Black",
    "Blackburn",
    "Blade",
    "Blanco",
    "Bloggins",
    "Borenstein",
    "Boyd",
    "Braxton",
    "Britin",
    "Brostr√∂m",
    "Brough",
    "Budd",
    "Bunnell",
    "Burgundy",
    "Burton",
    "Butcher",
    "Caboose",
    "Caliber",
    "Canuck",
    "Carr",
    "Carrico",
    "Cass",
    "Castaneda",
    "Castro",
    "Cazarotti",
    "Centeno",
    "Chance",
    "Chaney",
    "Chao",
    "Chase",
    "Chavez",
    "Chenovski",
    "Choi",
    "Chuland",
    "Citarelli",
    "Clockheart",
    "Collins",
    "Colvin",
    "Connelly",
    "Cooper",
    "Coots",
    "Cotton",
    "Couvillion",
    "Cowen",
    "Cox",
    "Craft",
    "Crapachi",
    "Cruz",
    "Currier",
    "Dallas",
    "Dalton",
    "DAmico",
    "Damien",
    "Dangler",
    "Davidson",
    "Davis",
    "Day",
    "DeMuyt",
    "Deniz",
    "Derry",
    "Di Perna",
    "Dio",
    "Dizdar",
    "Dmitry",
    "Dohun",
    "Dolack",
    "Donato",
    "Dornbierer",
    "Dracborne",
    "Dread",
    "Dyer",
    "Eagas",
    "Ellison",
    "Emerson",
    "Emmer",
    "Encino",
    "Enderle",
    "Enys",
    "Fagnant",
    "Field",
    "Fields",
    "Finch",
    "Fisher",
    "Flint",
    "Fluellen",
    "Fox",
    "Frohn",
    "Gann",
    "Garcia",
    "Gates",
    "Geki",
    "Gibbs",
    "Gill",
    "Gilnack",
    "Glick",
    "Goel",
    "Goings",
    "Gonzalez",
    "Gordon",
    "Goubeaud",
    "Green",
    "Grills",
    "Guerra",
    "Guknar",
    "Hackel",
    "Hamilton",
    "Hamm",
    "Hans",
    "Hayden",
    "Hayes",
    "Heberlig",
    "Henderson",
    "Hendrix",
    "Henson",
    "Hermes",
    "Hess",
    "Hetzel",
    "Hilton",
    "Hobbs",
    "Hoff",
    "Holt",
    "Hoover",
    "Hsieh",
    "Huber",
    "Huff",
    "Hughes",
    "Hunt",
    "Hunter",
    "Hutchings",
    "Huxley",
    "Ivanov",
    "Jackson",
    "Jacobs",
    "Jager",
    "James",
    "Jann",
    "Jarvis",
    "Jay",
    "Jefferzon",
    "Jerzy",
    "Jimenez",
    "Jinto",
    "John",
    "Jupiter",
    "Kal",
    "Kamenar",
    "Kastor",
    "Kavinsky",
    "Keenan",
    "Keif",
    "Kellogg",
    "Kerr",
    "King",
    "Kinser",
    "Kleinman",
    "Kling",
    "Knights",
    "Kogar",
    "Komar",
    "Konn",
    "Krauser",
    "Krawczyk",
    "Kubbo",
    "Lacasse",
    "LaCombe",
    "Lamb",
    "Landini",
    "Langlois",
    "Larios",
    "Larouche",
    "Lawrence",
    "Lee",
    "Legio",
    "Lemon",
    "Lewis",
    "Liber",
    "Lindberg",
    "Lindsay",
    "Little",
    "Lombardi",
    "Longmen",
    "Lopez",
    "Lucander",
    "Lucius",
    "Luz",
    "Lynch",
    "Macdonald",
    "Mack",
    "MacLaren",
    "MacMillan",
    "Maco",
    "Mairtine",
    "Marcus",
    "Mariani",
    "Marko",
    "Marougi",
    "Masnec",
    "Mazinski",
    "McGinnis",
    "McMaster",
    "McMillan",
    "McNeely",
    "Meyer",
    "Michelson",
    "Miller",
    "Mitsuma",
    "Mix",
    "Monk",
    "Moon",
    "Moore-Allen",
    "Moraru",
    "Morozov",
    "Morrow",
    "Mulholland",
    "Murdoc",
    "Muska",
    "Muth",
    "Myles",
    "Naman",
    "Nehez",
    "Nexhex",
    "Nguyen",
    "Ninde",
    "Nora",
    "Northwood",
    "Noun",
    "Nowakowsk",
    "Ocean",
    "ODoyle",
    "Oldham",
    "Ossko",
    "Otakar",
    "Otel",
    "Para",
    "Pazzolupo",
    "Perez",
    "Peters",
    "Phoenix",
    "Pimentel",
    "Plants",
    "Ponder",
    "Pontus",
    "Preacher",
    "Pregeant",
    "Profenno",
    "Queen",
    "Rabbot",
    "Ramirez",
    "Rangoo",
    "Ratcliff",
    "Rav",
    "Reach",
    "Reign",
    "Reyes",
    "Rhodes",
    "Rhone",
    "Ricks",
    "Ritzenthaler",
    "Rivard",
    "Rivas",
    "Rob",
    "Robbi",
    "Rock",
    "Rodahl",
    "Rogers",
    "Rollins",
    "Ronen",
    "Ronnings",
    "Rook",
    "Rosario",
    "Rosefield",
    "Royal",
    "Rozhkov",
    "Rugged",
    "Ryan",
    "Saint",
    "Sal",
    "Sap",
    "Savage",
    "Scarangella",
    "Schmidt",
    "Schultz",
    "Sharkey",
    "Shroom",
    "Shughart",
    "Simmons",
    "Simpson",
    "Sinca",
    "Singhal",
    "Skeith",
    "Sky",
    "Smith",
    "Snow",
    "Solo",
    "Sorrow",
    "Sotelo",
    "Sparrow",
    "Spaulding",
    "Spitnale",
    "Steinmann",
    "Stetchkov",
    "Stetson",
    "Steven",
    "Stevens",
    "Stewart",
    "Stoic",
    "Stone",
    "Storm",
    "Strider",
    "Sullivan",
    "Summerfield",
    "Sven",
    "Sweetwater",
    "Sypolt",
    "Taluto",
    "Taylor",
    "Tende",
    "Terlizzi",
    "Terp",
    "Tester",
    "Tharen",
    "Thomas",
    "Tiddens",
    "Trowbridge",
    "Trunkman",
    "Tucker",
    "Turner",
    "Tyrcon",
    "VanBeek",
    "Vargas",
    "Vein",
    "Velasquez",
    "Vercin",
    "Virgil",
    "Walsh",
    "Weaver",
    "Welsh",
    "West",
    "Whitehead",
    "Whitfield",
    "Whitley",
    "Whitsel",
    "Wiese",
    "Wildfire",
    "Williams",
    "Williamson",
    "Wilson",
    "Winters",
    "Wisser",
    "Wittkoff",
    "Wittman",
    "Wolf",
    "Wolfe",
    "Wulf",
    "Zabuden",
    "Zachary",
    "Zahr",
    "Zeng",
    "Zerbert",
    "Zimm",
    "Zimmerman",
    "Zubrican",
    "Zuphers"

$rankList=
    "RCT",
    "PVT",
    "PFC",
    "SPC",
    "CPL",
    "SGT",
    "SSG",
    "SFC",
    "MSG",
    "1SG",
    "SGM",
    "CSM",
    "2LT",
    "1LT",
    "CPT",
    "MAJ",
    "LTC",
    "COL"


foreach ($_name in $nameList) {
    $_nameLable = $_name.ToUpper()
    $_tempFile  = Join-Path "$tmp" "$($_name.toLower()).png"
    convert $templateFile -font arial-bold -gravity CENTER -pointsize 61 -annotate +0+15 "$_nameLable" $_tempFile
    foreach ($_rank in $rankList) {
        $_outputFileName   = "$($_name.toLower())_$($_rank.toLower())_ca"
        
        $_tempFilePNG      = "$($_outputFileName).png"
        $_tempPNGPath      = Join-Path "$tmp" "$_tempFilePNG"
        convert $_tempFile -font arial-bold -gravity North -pointsize 61 -annotate +0+90 "U.S. ARMY" $_tempFile

        $_rankFile         = Join-Path "$rankFiles" "$_rank.png"
        $_tempRankFile     = Join-Path "$tmp" "$($_name.toLower())_$($_rank.toLower()).png"
        composite $_tempFile $_rankFile $_tempRankFile
        convert $_tempRankFile -depth 12 -colorspace Transparent PNG32:$_tempRankFile

        $_outputFilePAA    = "$($_outputFileName).paa"
        $_outputPAAPath    = Join-Path "$output" "$_outputFilePAA"
        ImageToPAA "$_tempRankFile" "$_outputPAAPath"
    }
}

#Remove-Item "$tmp" -Recurse -Force
